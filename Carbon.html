<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Carbon.utf8.md</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">O'Neill-PhD</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Carbon.html">Carbon and Environment</a>
</li>
<li>
  <a href="NDVI.html">Carbon,NDVI and EVI</a>
</li>
<li>
  <a href="Human_C.html">Carbon and cities proximity</a>
</li>
<li>
  <a href="NFI-Avitabile.html">NFI and Avitabile Comparison</a>
</li>
<li>
  <a href="Fieldwork.html">Fieldwork Analysis</a>
</li>
<li>
  <a href="Species-Analysis.html">Species Analysis</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="carbon-stocks-assessment-wkgfgerklrltgith-national-forest-inventories-data" class="section level5">
<h5>Carbon stocks assessment wkgfgerklrltgith National Forest Inventories Data</h5>
<p><strong>Loading the required Packages</strong></p>
<pre class="r"><code>library(tidyverse)
library(dplyr)
library(ggplot2)
library(stringr)
library(maps)
library(mapdata)
library(maptools)
library(sp)
library(raster)
library(BIOMASS)
library(ape)
library(magrittr)
library(tinytex)
library(raster)
library(rgdal)</code></pre>
<p><strong>load the dataframe</strong></p>
<pre class="r"><code>Trees &lt;- read.csv(&quot;Data_Output/Final_dataframe(29-10-2019).csv&quot;, stringsAsFactors = F)
str(Trees)</code></pre>
<pre><code>## &#39;data.frame&#39;:    327623 obs. of  19 variables:
##  $ DIST        : chr  &quot;Pyay&quot; &quot;Pyay&quot; &quot;Pyay&quot; &quot;Pyay&quot; ...
##  $ TSP         : chr  &quot;Paukkaung&quot; &quot;Paukkaung&quot; &quot;Paukkaung&quot; &quot;Paukkaung&quot; ...
##  $ RF_PPF_UCF  : chr  &quot;North Nawin RF&quot; &quot;North Nawin RF&quot; &quot;North Nawin RF&quot; &quot;North Nawin RF&quot; ...
##  $ D_ID        : int  3 3 3 3 3 3 3 3 3 3 ...
##  $ GISID       : chr  &quot;1037&quot; &quot;1037&quot; &quot;1037&quot; &quot;1037&quot; ...
##  $ EAST        : int  789506 789506 789506 789506 789506 789506 789506 789506 789506 789506 ...
##  $ NORTH       : int  2121406 2121406 2121406 2121406 2121406 2121406 2121406 2121406 2121406 2121406 ...
##  $ ALT         : chr  &quot;234&quot; &quot;234&quot; &quot;234&quot; &quot;234&quot; ...
##  $ LC          : int  3 3 3 3 3 3 3 3 3 3 ...
##  $ FT          : int  63 63 63 63 63 63 63 63 63 63 ...
##  $ DEN         : int  2 2 2 2 2 2 2 2 2 2 ...
##  $ TNO         : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Species_Code: int  337 999 460 30 30 128 285 278 417 393 ...
##  $ DBH_mm      : int  410 450 540 780 760 500 290 460 600 600 ...
##  $ DBH_cm      : num  41 45 54 78 76 50 29 46 60 60 ...
##  $ Year        : int  2017 2017 2017 2017 2017 2017 2017 2017 2017 2017 ...
##  $ Genus       : chr  &quot;Premna&quot; &quot;Unknown&quot; &quot;Vitex&quot; &quot;Anogeissus&quot; ...
##  $ Species     : chr  &quot;pyramidata&quot; &quot;species&quot; &quot;pubescens&quot; &quot;acuminata&quot; ...
##  $ Plot_names  : chr  &quot;789506 _ 2121406&quot; &quot;789506 _ 2121406&quot; &quot;789506 _ 2121406&quot; &quot;789506 _ 2121406&quot; ...</code></pre>
<p><strong>Obtaining wood density</strong></p>
<p>Obtaining Wood density - getWoodDensity assigns to each taxon a species- or genus-level average if at least one wood density value in the same genus as the focal taxon is available in the reference database. For unidentified trees or if the genus is missing in the reference database, the stand-level mean wood density is assigned to the tree (based on trees for which a value was attributed).</p>
<pre class="r"><code>Taxo &lt;- correctTaxo(genus= Trees$Genus, species = Trees$Species)
Trees$genusCorr &lt;- Taxo$genusCorrected
Trees$speciesCorr &lt;- Taxo$speciesCorrected

APG &lt;- getTaxonomy(Trees$genusCorr, findOrder =T)

Trees$familyAPG &lt;- APG$family

Trees$orderAPG &lt;- APG$order
dataWD &lt;- getWoodDensity(genus=Trees$genusCorr,
                         species=Trees$speciesCorr,
                         stand=NULL, family = Trees$familyAPG, region = &quot;World&quot;)

Trees &lt;- Trees %&gt;% mutate(DBH_cm=DBH_mm/10) %&gt;% mutate(WD=dataWD$meanWD)</code></pre>
<p><strong>Building a Diameter Height Model based on the first year data</strong></p>
<pre class="r"><code>library(lme4)
Forests &lt;- read.csv(&quot;Data/All_data_Final.csv&quot;, stringsAsFactors = F)
names(Forests)</code></pre>
<pre><code>##  [1] &quot;Forest_type&quot;   &quot;Plot_id&quot;       &quot;Species_names&quot; &quot;Genus&quot;        
##  [5] &quot;Species&quot;       &quot;Family&quot;        &quot;Dbh_cm&quot;        &quot;H_m&quot;          
##  [9] &quot;WD&quot;            &quot;AGB&quot;           &quot;C_Tree&quot;        &quot;BA&quot;           
## [13] &quot;Lat&quot;           &quot;Long&quot;          &quot;Northing&quot;      &quot;Easting&quot;      
## [17] &quot;Tenure&quot;</code></pre>
<pre class="r"><code>Forests &lt;- filter(Forests,!is.na(Species_names) &amp; !is.na(Dbh_cm))
summary(Forests)</code></pre>
<pre><code>##  Forest_type           Plot_id       Species_names         Genus          
##  Length:4444        Min.   :  1.00   Length:4444        Length:4444       
##  Class :character   1st Qu.: 23.00   Class :character   Class :character  
##  Mode  :character   Median : 53.00   Mode  :character   Mode  :character  
##                     Mean   : 55.69                                        
##                     3rd Qu.: 89.00                                        
##                     Max.   :119.00                                        
##    Species             Family              Dbh_cm            H_m         
##  Length:4444        Length:4444        Min.   :  3.00   Min.   : 0.3048  
##  Class :character   Class :character   1st Qu.: 10.00   1st Qu.: 9.1440  
##  Mode  :character   Mode  :character   Median : 14.50   Median :15.2400  
##                                        Mean   : 19.02   Mean   :19.5457  
##                                        3rd Qu.: 24.00   3rd Qu.:25.3049  
##                                        Max.   :137.00   Max.   :83.0000  
##        WD              AGB                C_Tree        
##  Min.   :0.2200   Min.   : 0.001082   Min.   :0.000508  
##  1st Qu.:0.6014   1st Qu.: 0.042343   1st Qu.:0.019901  
##  Median :0.7200   Median : 0.136046   Median :0.063941  
##  Mean   :0.7164   Mean   : 0.523717   Mean   :0.246147  
##  3rd Qu.:0.8500   3rd Qu.: 0.477241   3rd Qu.:0.224303  
##  Max.   :1.0950   Max.   :20.000150   Max.   :9.400070  
##        BA                Lat             Long          Northing      
##  Min.   :0.000707   Min.   :18.88   Min.   :95.22   Min.   :2089871  
##  1st Qu.:0.007854   1st Qu.:20.85   1st Qu.:95.24   1st Qu.:2306949  
##  Median :0.016513   Median :20.89   Median :95.26   Median :2311426  
##  Mean   :0.042563   Mean   :20.66   Mean   :95.34   Mean   :2285967  
##  3rd Qu.:0.045239   3rd Qu.:20.91   3rd Qu.:95.27   3rd Qu.:2313971  
##  Max.   :1.474114   Max.   :20.93   Max.   :96.08   Max.   :2316236  
##     Easting          Tenure         
##  Min.   :193210   Length:4444       
##  1st Qu.:732675   Class :character  
##  Median :734513   Mode  :character  
##  Mean   :729817                     
##  3rd Qu.:736259                     
##  Max.   :809669</code></pre>
<pre class="r"><code>unique(Forests$Forest_type)</code></pre>
<pre><code>## [1] &quot;Dipterocarpus_Forest&quot;         &quot;Dry_Forest&quot;                  
## [3] &quot;Dry_Hill_Forest&quot;              &quot;Dry_Mixed_Deciduous_Forest&quot;  
## [5] &quot;Moist_Mixed_Deciduous_Forest&quot;</code></pre>
<pre class="r"><code>Selected_Forests &lt;- Forests %&gt;% filter(Forest_type==&quot;Moist_Mixed_Deciduous_Forest&quot;)
LogDH_Selected_Forests &lt;- Selected_Forests %&gt;% mutate(LogDbh_cm=log(Dbh_cm)) %&gt;% mutate(LogH_m=log(H_m))
ggplot(data = Selected_Forests, aes(Dbh_cm, H_m, color=Forest_type) )+ geom_point()</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>ModelForHeight &lt;- lmer(log(H_m)~log(Dbh_cm)+(1|Plot_id), REML = FALSE, data = Selected_Forests)
ModelForHeight</code></pre>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: log(H_m) ~ log(Dbh_cm) + (1 | Plot_id)
##    Data: Selected_Forests
##      AIC      BIC   logLik deviance df.resid 
## 119.4670 136.9671 -55.7335 111.4670      583 
## Random effects:
##  Groups   Name        Std.Dev.
##  Plot_id  (Intercept) 0.1565  
##  Residual             0.2558  
## Number of obs: 587, groups:  Plot_id, 18
## Fixed Effects:
## (Intercept)  log(Dbh_cm)  
##      0.5433       0.6719</code></pre>
<pre class="r"><code>ranef(ModelForHeight)$Plot_id[,1] %&gt;% hist(breaks=10)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<pre class="r"><code>ModelForHeight_Log &lt;- lmer(LogH_m~LogDbh_cm +(1|Plot_id), REML = FALSE, data = LogDH_Selected_Forests)
ModelForHeight_Log</code></pre>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: LogH_m ~ LogDbh_cm + (1 | Plot_id)
##    Data: LogDH_Selected_Forests
##      AIC      BIC   logLik deviance df.resid 
## 119.4670 136.9671 -55.7335 111.4670      583 
## Random effects:
##  Groups   Name        Std.Dev.
##  Plot_id  (Intercept) 0.1565  
##  Residual             0.2558  
## Number of obs: 587, groups:  Plot_id, 18
## Fixed Effects:
## (Intercept)    LogDbh_cm  
##      0.5433       0.6719</code></pre>
<p><strong><strong>The best possible random effect model</strong></strong></p>
<pre class="r"><code>summary(ModelForHeight_Log)</code></pre>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: LogH_m ~ LogDbh_cm + (1 | Plot_id)
##    Data: LogDH_Selected_Forests
## 
##      AIC      BIC   logLik deviance df.resid 
##    119.5    137.0    -55.7    111.5      583 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -6.6389 -0.5303  0.0305  0.5817  3.1785 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  Plot_id  (Intercept) 0.02449  0.1565  
##  Residual             0.06543  0.2558  
## Number of obs: 587, groups:  Plot_id, 18
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  0.54327    0.08372   6.489
## LogDbh_cm    0.67192    0.02149  31.272
## 
## Correlation of Fixed Effects:
##           (Intr)
## LogDbh_cm -0.889</code></pre>
<pre class="r"><code>ranef(ModelForHeight_Log)$Plot_id[,1] %&gt;% hist()</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-5-1.png" width="672" /> Getting tree Height based on the best model and substracted the lowest random effect of the plot no. 115 from every plots of the dataframe that I need to predict Height. Plot no. 115 had the lowest random effect number.</p>
<pre class="r"><code>Trees$H_pred &lt;- predict(ModelForHeight_Log, data.frame(LogDbh_cm= log(Trees$DBH_cm), Plot_id=115))
Trees &lt;- Trees %&gt;%
  mutate(AdjustH_Pred=exp(H_pred))</code></pre>
<p>Testing the DBH and Height relationship for trees—–</p>
<pre class="r"><code>ggplot(data = Trees, aes(DBH_cm, AdjustH_Pred) )+ geom_point()</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p><strong><em>Calculating the biomass of each tree</em></strong></p>
<p>Where, D = Tree diameter (in cm), either a vector or a single value Wood density (in g/cm3), either a vector or a single value. Tree height (H in m), either a vector or a single value.</p>
<pre class="r"><code>CoordsH &lt;- cbind(Trees$EAST, Trees$NORTH)
Trees &lt;- Trees %&gt;% mutate(AGB=computeAGB(D = DBH_cm, WD = WD, H = AdjustH_Pred, coord = CoordsH, Dlim = NULL))
Trees &lt;- Trees %&gt;% mutate(Carbon_Mg= AGB*0.471)
write.csv(Trees, file = &quot;Data_Output/Trees.csv&quot;, row.names = F)</code></pre>
<p><strong>Sampling Method</strong></p>
<p>image: <img src="Figures/Sampling%20Design.PNG" /></p>
<p>1 ha sample plot with a 50m * 50 m nested plot. Therefore, the big dataframe was splitted into two according to the DBH limit measured in the 50m * 50m subplot. <em>(100m x 100m and 50m x 50m)</em></p>
<pre class="r"><code>Trees &lt;- read.csv(&quot;Data_Output/Trees.csv&quot;, stringsAsFactors = F)
Trees &lt;- droplevels(Trees)
Trees_1ha &lt;- Trees %&gt;% filter(DBH_mm &gt;= 200)
Trees_50m &lt;- Trees %&gt;% filter(DBH_mm &lt; 200)</code></pre>
<p>** Calculating the carbon per ha for two different size plots**</p>
<pre class="r"><code>Plot_1ha &lt;- Trees_1ha %&gt;%
  group_by(Plot_names,DIST,Year, EAST, NORTH) %&gt;%
  dplyr::summarise(C_ha = sum(Carbon_Mg))

Plot_50M &lt;- Trees_50m %&gt;%
  group_by(Plot_names,DIST,Year, EAST, NORTH) %&gt;%
  dplyr::summarise(C_Tree_total = sum(Carbon_Mg)) %&gt;%
  mutate(C_ha=C_Tree_total/0.25) %&gt;% dplyr::select(-C_Tree_total)</code></pre>
<p>Combining two dataframes of different plot size according to Plot names.In this process, <em>NA</em> values- generated were replaced with zero in order to add carbon per ha of different plot size together. Carbon per hectare columns of the two dataframes were added together to obtain total carbon of each plot in hectare scale.</p>
<pre class="r"><code>All_Plots &lt;- bind_rows(Plot_1ha,Plot_50M) %&gt;% group_by(Plot_names,Year,DIST,EAST, NORTH) %&gt;% summarise(Sum_CHa=sum(C_ha))
droplevels(All_Plots)</code></pre>
<pre><code>## # A tibble: 8,172 x 6
## # Groups:   Plot_names, Year, DIST, EAST [8,172]
##    Plot_names        Year DIST    EAST   NORTH Sum_CHa
##    &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;  &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt;
##  1 185000 _ 2029000  2012 Bago  185000 2029000    3.82
##  2 185000 _ 2031000  2012 Bago  185000 2031000   10.2 
##  3 185000 _ 2033000  2012 Bago  185000 2033000   10.9 
##  4 185000 _ 2035000  2012 Bago  185000 2035000    9.33
##  5 185000 _ 2037000  2012 Bago  185000 2037000   12.4 
##  6 185000 _ 2039000  2012 Bago  185000 2039000   11.1 
##  7 185000 _ 2041000  2012 Bago  185000 2041000   16.6 
##  8 187000 _ 2027000  2012 Bago  187000 2027000    3.43
##  9 187000 _ 2029000  2012 Bago  187000 2029000    8.92
## 10 187000 _ 2031000  2012 Bago  187000 2031000   13.9 
## # ... with 8,162 more rows</code></pre>
<pre class="r"><code>hist(All_Plots$Sum_CHa, breaks=100)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><strong>Producing a clean dataframe</strong></p>
<pre class="r"><code>All_Plots$Year &lt;- as.factor(All_Plots$Year)
summary(All_Plots)</code></pre>
<pre><code>##   Plot_names             Year          DIST                EAST        
##  Length:8172        2014   :2824   Length:8172        Min.   : 185000  
##  Class :character   2013   :1100   Class :character   1st Qu.: 629000  
##  Mode  :character   2015   :1024   Mode  :character   Median : 680002  
##                     2010   : 957                      Mean   : 839850  
##                     2016   : 824                      3rd Qu.: 766000  
##                     2012   : 566                      Max.   :2199000  
##                     (Other): 877                                       
##      NORTH            Sum_CHa         
##  Min.   : 181974   Min.   :  0.03207  
##  1st Qu.:2052655   1st Qu.:  6.26052  
##  Median :2470006   Median : 10.95067  
##  Mean   :2124797   Mean   : 15.36247  
##  3rd Qu.:2646000   3rd Qu.: 19.75048  
##  Max.   :2824000   Max.   :263.42935  
## </code></pre>
<pre class="r"><code>write.csv(All_Plots, file = &quot;Data_Output/All_plots.csv&quot;, row.names = F)</code></pre>
<pre class="r"><code>ggplot(data = All_Plots, aes(x = DIST, y= log(Sum_CHa), color= Year))+ 
  geom_boxplot()+
  labs(title = &quot;Carbon storage per ha in 21 disctricts from 2010 to 2017&quot;, 
       x= &quot;District name&quot;,
       y= &quot;Carbon(t/ha)&quot;)+
  theme(axis.text.x = element_text(size=7, angle = 90, vjust = 0.5),
        axis.text.y = element_text(size = 7))</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>This section describes how the plots’ location errors were fixed. All plots’ locations were plotted according to 46 Q and 47 Q CRS. Then, plots located in 46 Q zone and 47 Q zone were sliced from the main dataframe. The remaining plots wich were outside of the country boundry were thoroughly checked for theirs north and east location. It found that North and East were the other way wrong. So, I renamed East to North and North to East.After that, most of the plots are back in the country boundary area.However, some plots were still in the wrong positions. So, I had to slice the edited 46 and 47 Out dataframes as 46 Adjusted and 47 Adjusted (which are the plots that have to be shifted from their position as they were in the paddy fieds instead of being in the forest). The closet plots which are in the right position were referenced to move the wrong plots. (E.g checked the right plot’s North and East and possible typo errors such as 9 to 5 or flipping the numbers front to back and back to front). Then, the adjusted 46Q plots and 47Q plots were joined back to the 46Out and 47Out dataframe to obtain the total plots numbers that have been fixed for the right locations by using r bind funciton. Then the corrected plots locations dataframe was joined with the carbon-per-plot dataframe which has the wrong North and East by excluding them based on the plots_names. Finally, the dataframe which as the right plot locations and carbon per plot was created. Based on the final plot_carbon dataframe, shape file of the plot locations(edited) was produced. This shape file will be used to extract the remotely sensed data from the Google Earth Engine.</p>
<pre class="r"><code>library(tidyverse)
library(dplyr)
library(ggplot2)
library(stringr)
library(maps)
library(mapdata)
library(maptools)
library(sp)
library(raster)
library(BIOMASS)
library(ape)
library(magrittr)
library(tinytex)
library(raster)
library(rgdal)

In_46 &lt;- read.csv(&quot;Data_Output/Qgis_edited_Plots_Locations and Carbon/In_Plots46.csv&quot;,stringsAsFactors = F)
In_47 &lt;- read.csv(&quot;Data_Output/Qgis_edited_Plots_Locations and Carbon/In_Plots47.csv&quot;,stringsAsFactors = F)
Out_47 &lt;- read.csv(&quot;Data_Output/Qgis_edited_Plots_Locations and Carbon/Out_47.csv&quot;, stringsAsFactors = F)
Out_46 &lt;- read.csv(&quot;Data_Output/Qgis_edited_Plots_Locations and Carbon/Out_46.csv&quot;, stringsAsFactors = F)
Out_46Adjusted &lt;- read.csv(&quot;Data_Output/Qgis_edited_Plots_Locations and Carbon/46 Adjusted.csv&quot;, stringsAsFactors = F)
Out_47Adjusted &lt;- read.csv(&quot;Data_Output/Qgis_edited_Plots_Locations and Carbon/47 Adjusted.csv&quot;,stringsAsFactors = F)


Out46RowToBeRemoved &lt;- Out_46Adjusted$Plot_names
Cleaned_Out46 &lt;- Out_46[-which(Out_46$Plot_names %in% Out46RowToBeRemoved),]
New_Out46 &lt;- rbind(Cleaned_Out46,Out_46Adjusted)                  
                  

Out47RowToBeRemoved &lt;- Out_47Adjusted$Plot_names
Cleaned_Out47 &lt;- Out_47[-which(Out_47$Plot_names %in% Out47RowToBeRemoved),]
New_Out47 &lt;- rbind(Cleaned_Out47,Out_47Adjusted)   
   

Lcorrected_Plots &lt;- rbind(In_46,In_47,New_Out46, New_Out47)
Carbon &lt;- read.csv(&quot;Data_Output/All_plots.csv&quot;, stringsAsFactors = F)
Carbon &lt;- Carbon %&gt;% dplyr::select(Plot_names,Sum_CHa)
Plot_Carbon &lt;- left_join(Lcorrected_Plots,Carbon, by=&quot;Plot_names&quot;)


str(Plot_Carbon)</code></pre>
<pre><code>## &#39;data.frame&#39;:    8175 obs. of  7 variables:
##  $ Plot_names: chr  &quot;591000 _ 2275000&quot; &quot;591000 _ 2277000&quot; &quot;591000 _ 2280000&quot; &quot;593000 _ 2275000&quot; ...
##  $ Year      : int  2013 2013 2013 2013 2013 2013 2013 2013 2013 2013 ...
##  $ DIST      : chr  &quot;Minbu&quot; &quot;Minbu&quot; &quot;Minbu&quot; &quot;Minbu&quot; ...
##  $ EAST      : int  591000 591000 591000 593000 593000 593000 594000 595000 595000 595000 ...
##  $ NORTH     : int  2275000 2277000 2280000 2275000 2277000 2279000 2283000 2275000 2277000 2279000 ...
##  $ Zone      : int  46 46 46 46 46 46 46 46 46 46 ...
##  $ Sum_CHa   : num  8.2 6.56 5 9.39 8.74 ...</code></pre>
<pre class="r"><code>summary(Plot_Carbon)</code></pre>
<pre><code>##   Plot_names             Year          DIST                EAST       
##  Length:8175        Min.   :2010   Length:8175        Min.   :181974  
##  Class :character   1st Qu.:2013   Class :character   1st Qu.:237000  
##  Mode  :character   Median :2014   Mode  :character   Median :660008  
##                     Mean   :2014                      Mean   :564012  
##                     3rd Qu.:2015                      3rd Qu.:716000  
##                     Max.   :2017                      Max.   :817813  
##      NORTH              Zone          Sum_CHa         
##  Min.   :1897000   Min.   :46.00   Min.   :  0.03207  
##  1st Qu.:2107054   1st Qu.:46.00   1st Qu.:  6.26089  
##  Median :2471000   Median :46.00   Median : 10.94829  
##  Mean   :2401019   Mean   :46.28   Mean   : 15.36008  
##  3rd Qu.:2646000   3rd Qu.:47.00   3rd Qu.: 19.74903  
##  Max.   :2824000   Max.   :47.00   Max.   :263.42935</code></pre>
<pre class="r"><code>world2HiresMapEnv</code></pre>
<pre><code>## [1] &quot;R_MAPDATA_DATA_DIR&quot;</code></pre>
<pre class="r"><code>data(wrld_simpl)
myanmar &lt;- wrld_simpl[wrld_simpl$NAME==&quot;Burma&quot;,]
plot(myanmar)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>myanmar_utm46 &lt;- spTransform(myanmar, &quot;+init=epsg:32646&quot;)
myanmar_utm47 &lt;- spTransform(myanmar, &quot;+init=epsg:32647&quot;)
plot(myanmar_utm47)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<pre class="r"><code>plot(myanmar_utm46)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
<pre class="r"><code># Loading the known plots and add a colum called Zone (46/47)----

coords46 &lt;- Plot_Carbon %&gt;% 
  filter(Zone==46)

coords47 &lt;-Plot_Carbon %&gt;% 
  filter(Zone ==47) 


coords46 = SpatialPoints(cbind(coords46$EAST, coords46$NORTH))
proj4string(coords46) = CRS(&quot;+init=epsg:32646&quot;)
coords46&lt;-spTransform(coords46, &quot;+init=epsg:4326&quot;)

coords47 = SpatialPoints(cbind(coords47$EAST, coords47$NORTH))
proj4string(coords47) = CRS(&quot;+init=epsg:32647&quot;)
coords47&lt;-spTransform(coords47, &quot;+init=epsg:4326&quot;)

par(mar=c(4,4,2,2), mfrow =c(2,2))
plot(myanmar, border = &quot;red&quot;)
plot(coords46, add = TRUE, cex = 0.1, col = &quot;blue&quot;)
plot(coords47, add= TRUE, cex = 0.1, col = &quot;green&quot;)

Plot_Carbon$Year &lt;- as.factor(Plot_Carbon$Year)
ggplot(data = Plot_Carbon, aes(x = DIST, y= log(Sum_CHa), color= Year))+ 
  geom_boxplot()+
  labs(title = &quot;Carbon storage per ha in 21 disctricts from 2010 to 2017&quot;, 
       x= &quot;District name&quot;,
       y= &quot;Carbon(t/ha)&quot;)+
  theme(axis.text.x = element_text(size=7, angle = 90, vjust = 0.5),
        axis.text.y = element_text(size = 7))

glm.CarbonDistrict &lt;- glm(log(Sum_CHa)~DIST, data = Plot_Carbon, family= gaussian(link=&quot;identity&quot;) )
anova(glm.CarbonDistrict)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model: gaussian, link: identity
## 
## Response: log(Sum_CHa)
## 
## Terms added sequentially (first to last)
## 
## 
##      Df Deviance Resid. Df Resid. Dev
## NULL                  8174     9019.3
## DIST 21   1461.3      8153     7557.9</code></pre>
<pre class="r"><code>plot(glm.CarbonDistrict)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-15-4.png" width="672" /></p>
<pre class="r"><code>summary(glm.CarbonDistrict)</code></pre>
<pre><code>## 
## Call:
## glm(formula = log(Sum_CHa) ~ DIST, family = gaussian(link = &quot;identity&quot;), 
##     data = Plot_Carbon)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -5.9140  -0.4895   0.0612   0.6094   3.2033  
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      1.58027    0.04047  39.048  &lt; 2e-16 ***
## DISTGangaw       1.09037    0.06782  16.077  &lt; 2e-16 ***
## DISTKale         1.06494    0.05203  20.468  &lt; 2e-16 ***
## DISTKatha        0.91479    0.05510  16.602  &lt; 2e-16 ***
## DISTKhamti       0.79021    0.05113  15.454  &lt; 2e-16 ***
## DISTKyaukse      0.89394    0.08518  10.494  &lt; 2e-16 ***
## DISTMagway       0.44788    0.34280   1.307   0.1914    
## DISTMandalay     0.18788    0.22456   0.837   0.4028    
## DISTMawlaik      1.38396    0.05098  27.150  &lt; 2e-16 ***
## DISTMeiktila     0.19949    0.10926   1.826   0.0679 .  
## DISTMinbu        0.81782    0.06016  13.595  &lt; 2e-16 ***
## DISTMonywa       1.19506    0.08089  14.774  &lt; 2e-16 ***
## DISTPakokku      0.72237    0.17242   4.190 2.82e-05 ***
## DISTPyay         0.47291    0.06458   7.323 2.66e-13 ***
## DISTPYAY         0.02476    0.12697   0.195   0.8454    
## DISTPyinOoLwin   0.43265    0.06012   7.196 6.73e-13 ***
## DISTShwebo       0.58691    0.08383   7.001 2.74e-12 ***
## DISTTamu         0.67095    0.14616   4.591 4.49e-06 ***
## DISTTaunggoo     0.35140    0.05105   6.883 6.30e-12 ***
## DISTThayarwaddy  0.02089    0.06096   0.343   0.7319    
## DISTThayet       0.88753    0.07052  12.586  &lt; 2e-16 ***
## DISTYamethin     0.08024    0.11438   0.702   0.4830    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.9270118)
## 
##     Null deviance: 9019.3  on 8174  degrees of freedom
## Residual deviance: 7557.9  on 8153  degrees of freedom
## AIC: 22604
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<pre class="r"><code>Grid46 &lt;- Plot_Carbon %&gt;% filter(Zone==&quot;46&quot;)

Grid47 &lt;- Plot_Carbon %&gt;% filter(Zone==&quot;47&quot;)

coords46 = SpatialPoints(cbind(Grid46$EAST, Grid46$NORTH))
proj4string(coords46) = CRS(&quot;+init=epsg:32646&quot;)
coords46 &lt;- spTransform(coords46, &quot;+init=epsg:4326&quot;)

coords47 = SpatialPoints(cbind(Grid47$EAST, Grid47$NORTH))
proj4string(coords47) = CRS(&quot;+init=epsg:32647&quot;)
coords47 &lt;- spTransform(coords47, &quot;+init=epsg:4326&quot;)

Plots_location &lt;- rbind(coords46,coords47) 

spdf = SpatialPointsDataFrame(Plots_location,data = Plot_Carbon)

writeOGR(spdf,&quot;locations_WGS84Edited.shp&quot;, layer=&quot;plot_locations&quot;, driver = &quot;ESRI Shapefile&quot;)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-15-5.png" width="672" /></p>
<p>This section describes how carbon storage of all the plots are different according to the ecoregions published by WWF.The plot locations shape file and ecoregion shape files ware used with QGIS to extract which plots belong to which ecoregions. The function called “Join attributed by locations” was used in this process.</p>
<pre class="r"><code>Ecoregions &lt;- read.csv(&quot;Data_Output/Ecoregion-Plots-Edited(31-10-2019).csv&quot;, stringsAsFactors = F)
glm.CarbonEcoregions &lt;- glm(log(Sum_CHa)~ECO_NAME, data = Ecoregions, family = gaussian(link = &quot;identity&quot;))
anova(glm.CarbonEcoregions)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model: gaussian, link: identity
## 
## Response: log(Sum_CHa)
## 
## Terms added sequentially (first to last)
## 
## 
##          Df Deviance Resid. Df Resid. Dev
## NULL                      8174     8870.9
## ECO_NAME  6   442.34      8168     8428.6</code></pre>
<pre class="r"><code>plot(glm.CarbonEcoregions)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-16-1.png" width="672" /><img src="Carbon_files/figure-html/unnamed-chunk-16-2.png" width="672" /><img src="Carbon_files/figure-html/unnamed-chunk-16-3.png" width="672" /><img src="Carbon_files/figure-html/unnamed-chunk-16-4.png" width="672" /></p>
<pre class="r"><code>summary(glm.CarbonEcoregions)</code></pre>
<pre><code>## 
## Call:
## glm(formula = log(Sum_CHa) ~ ECO_NAME, family = gaussian(link = &quot;identity&quot;), 
##     data = Ecoregions)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -5.6755  -0.4703   0.0883   0.6506   3.0578  
## 
## Coefficients:
##                                                 Estimate Std. Error
## (Intercept)                                     2.483172   0.038123
## ECO_NAMEIrrawaddy Dry Forests                   0.350752   0.073636
## ECO_NAMEIrrawaddy Moist Deciduous Forests      -0.202172   0.041490
## ECO_NAMEKayah-Karen Montane Rain Forests       -0.583397   0.107564
## ECO_NAMEMizoram-Manipur-Kachin Rain Forests    -0.009885   0.044575
## ECO_NAMEMyanmar Coastal Rain Forests           -0.710824   0.051786
## ECO_NAMENorthern Indochina Subtropical Forests -0.455724   0.060064
##                                                t value Pr(&gt;|t|)    
## (Intercept)                                     65.135  &lt; 2e-16 ***
## ECO_NAMEIrrawaddy Dry Forests                    4.763 1.94e-06 ***
## ECO_NAMEIrrawaddy Moist Deciduous Forests       -4.873 1.12e-06 ***
## ECO_NAMEKayah-Karen Montane Rain Forests        -5.424 6.00e-08 ***
## ECO_NAMEMizoram-Manipur-Kachin Rain Forests     -0.222    0.825    
## ECO_NAMEMyanmar Coastal Rain Forests           -13.726  &lt; 2e-16 ***
## ECO_NAMENorthern Indochina Subtropical Forests  -7.587 3.63e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 1.031901)
## 
##     Null deviance: 8870.9  on 8174  degrees of freedom
## Residual deviance: 8428.6  on 8168  degrees of freedom
## AIC: 23465
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<pre class="r"><code>boxplot(log(Sum_CHa)~ECO_NAME, data = Ecoregions)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>aov.CarbonEcoregions &lt;- aov(Sum_CHa~ECO_NAME, data = Ecoregions)
summary(aov.CarbonEcoregions)</code></pre>
<pre><code>##               Df  Sum Sq Mean Sq F value Pr(&gt;F)    
## ECO_NAME       6   57143    9524   46.93 &lt;2e-16 ***
## Residuals   8168 1657535     203                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>ggplot(data=Ecoregions, aes(x=ECO_NAME, y = log(Sum_CHa), color=ECO_NAME))+ geom_boxplot()+
  labs(title = &quot;Carbon storage according to ecoregions&quot;, 
       x= &quot;Ecoregion&quot;,
       y= &quot;MaxCarbon(t/ha)&quot;)+
  theme(axis.text.x = element_text(size=7, angle = 90, vjust = 0.5),
        axis.text.y = element_text(size = 7))</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-17-2.png" width="672" /></p>
<p><strong>Carbon and environmental conditions relationship</strong></p>
<p>BIO1 = Annual Mean Temperature<br />
BIO2 = Mean Diurnal Range (Mean of monthly (max temp - min temp))<br />
BIO3 = Isothermality (BIO2/BIO7) (* 100)<br />
BIO4 = Temperature Seasonality (standard deviation *100)<br />
BIO5 = Max Temperature of Warmest Month<br />
BIO6 = Min Temperature of Coldest Month<br />
BIO7 = Temperature Annual Range (BIO5-BIO6)<br />
BIO8 = Mean Temperature of Wettest Quarter<br />
BIO9 = Mean Temperature of Driest Quarter<br />
BIO10 = Mean Temperature of Warmest Quarter<br />
BIO11 = Mean Temperature of Coldest Quarter<br />
BIO12 = Annual Precipitation<br />
BIO13 = Precipitation of Wettest Month<br />
BIO14 = Precipitation of Driest Month<br />
BIO15 = Precipitation Seasonality (Coefficient of Variation)<br />
BIO16 = Precipitation of Wettest Quarter<br />
BIO17 = Precipitation of Driest Quarter<br />
BIO18 = Precipitation of Warmest Quarter<br />
BIO19 = Precipitation of Coldest Quarter</p>
<p>I performed a simple liner regression analysis on the two variables Carbon and Annual precipitaion(AP)/Annual Mean Temperature(AMT). I wish to determine wheter the AP/AMT varible is a significant predictor of the Carbon Variable.</p>
<pre class="r"><code>Env &lt;- read.csv(&quot;Data_Output/WCL_plots_edited(31-10-2019).csv&quot;)</code></pre>
<pre class="r"><code>plot(Sum_CHa~bio01, data = Env)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code>glm.AMT &lt;- glm(log(Sum_CHa)~bio01,data=Env, family = gaussian(link = &quot;identity&quot;))
summary(glm.AMT)</code></pre>
<pre><code>## 
## Call:
## glm(formula = log(Sum_CHa) ~ bio01, family = gaussian(link = &quot;identity&quot;), 
##     data = Env)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -5.8069  -0.4910   0.0786   0.6569   3.1932  
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  5.2827674  0.1561265   33.84   &lt;2e-16 ***
## bio01       -0.0124258  0.0006465  -19.22   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 1.038453)
## 
##     Null deviance: 8870.9  on 8174  degrees of freedom
## Residual deviance: 8487.3  on 8173  degrees of freedom
## AIC: 23512
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<pre class="r"><code>plot(glm.AMT)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-19-2.png" width="672" /><img src="Carbon_files/figure-html/unnamed-chunk-19-3.png" width="672" /><img src="Carbon_files/figure-html/unnamed-chunk-19-4.png" width="672" /><img src="Carbon_files/figure-html/unnamed-chunk-19-5.png" width="672" /></p>
<pre class="r"><code># According to Year 
ggplot(data=Env, aes(x=log(bio01), y = log(Sum_CHa), color=DIST))+ geom_line()+
  facet_wrap(facets = vars(Year))+
  labs(title = &quot;Carbon storage and Annual Mean Temperature Relationship according to Census Year&quot;, 
       x= &quot;Log Annual Mean Temperature&quot;,
       y= &quot;Log Carbon(t/ha)&quot;)+
  theme(axis.text.x = element_text(size=7, angle = 45, vjust = 0.5),
        axis.text.y = element_text(size = 7))</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-19-6.png" width="672" /></p>
<pre class="r"><code>plot(log(Sum_CHa)~bio12, data = Env)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code>glm.AMP &lt;- glm(log(Sum_CHa)~bio12, data=Env, family = gaussian(link = &quot;identity&quot;))
anova(glm.AMP)</code></pre>
<pre><code>## Analysis of Deviance Table
## 
## Model: gaussian, link: identity
## 
## Response: log(Sum_CHa)
## 
## Terms added sequentially (first to last)
## 
## 
##       Df Deviance Resid. Df Resid. Dev
## NULL                   8174     8870.9
## bio12  1   1.6046      8173     8869.3</code></pre>
<pre class="r"><code>summary(glm.AMP)</code></pre>
<pre><code>## 
## Call:
## glm(formula = log(Sum_CHa) ~ bio12, family = gaussian(link = &quot;identity&quot;), 
##     data = Env)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -5.6969  -0.4616   0.0959   0.6774   3.2550  
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.3469599  0.0484333  48.458   &lt;2e-16 ***
## bio12       -0.0000327  0.0000269  -1.216    0.224    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 1.085196)
## 
##     Null deviance: 8870.9  on 8174  degrees of freedom
## Residual deviance: 8869.3  on 8173  degrees of freedom
## AIC: 23872
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<pre class="r"><code>ggplot(data=Env, aes(x=bio12, y = log(Sum_CHa), color=DIST))+ geom_point(alpha=1/5)+
  labs(title = &quot;Carbon storage and Annual Precipitation Relationship&quot;, 
       x= &quot;Annual Annual Precipitation (mm)&quot;,
       y= &quot;Carbon(t/ha)&quot;)+
   theme(axis.text.x = element_text(size=7, angle = 90, vjust = 0.5),
        axis.text.y = element_text(size = 7))</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-20-2.png" width="672" /></p>
<pre class="r"><code>theme(axis.text.x = element_text(size=7, angle = 45, vjust = 0.5),
        axis.text.y = element_text(size = 7))</code></pre>
<pre><code>## List of 2
##  $ axis.text.x:List of 11
##   ..$ family       : NULL
##   ..$ face         : NULL
##   ..$ colour       : NULL
##   ..$ size         : num 7
##   ..$ hjust        : NULL
##   ..$ vjust        : num 0.5
##   ..$ angle        : num 45
##   ..$ lineheight   : NULL
##   ..$ margin       : NULL
##   ..$ debug        : NULL
##   ..$ inherit.blank: logi FALSE
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  $ axis.text.y:List of 11
##   ..$ family       : NULL
##   ..$ face         : NULL
##   ..$ colour       : NULL
##   ..$ size         : num 7
##   ..$ hjust        : NULL
##   ..$ vjust        : NULL
##   ..$ angle        : NULL
##   ..$ lineheight   : NULL
##   ..$ margin       : NULL
##   ..$ debug        : NULL
##   ..$ inherit.blank: logi FALSE
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;element_text&quot; &quot;element&quot;
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;theme&quot; &quot;gg&quot;
##  - attr(*, &quot;complete&quot;)= logi FALSE
##  - attr(*, &quot;validate&quot;)= logi TRUE</code></pre>
<pre class="r"><code># According to Year 
ggplot(data=Env, aes(x=bio12, y = log(Sum_CHa), color=DIST))+ geom_line()+
  # facet_wrap(facets = vars(DIST))+
  labs(title = &quot;Carbon storage and Annual Precipitation (mm) Relationship According to Census Year&quot;, 
       x= &quot;Annual Precipitation (mm)&quot;,
       y= &quot;Carbon(t/ha)&quot;)+
  theme(axis.text.x = element_text(size=7, angle = 90, vjust = 0.5),
        axis.text.y = element_text(size = 7))</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code>n&lt;-10000

rsq&lt;-vector(n, mode = &#39;numeric&#39;)
pval&lt;-vector(n, mode = &#39;numeric&#39;)
for(i in 1:n){
  
x&lt;-rnorm(100)
y&lt;-rnorm(100)

fm&lt;-lm(y~x)

fm_sum&lt;-summary(fm)
rsq[[i]]&lt;-fm_sum$r.squared
pval[[i]]&lt;-fm_sum$coefficients[2,4]
}

hist(rsq, breaks = 100)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code>hist(pval, breaks = 100)</code></pre>
<p><img src="Carbon_files/figure-html/unnamed-chunk-22-2.png" width="672" /></p>
<pre class="r"><code>(sum(pval&lt;0.05) / length(pval))*100</code></pre>
<pre><code>## [1] 5.14</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
